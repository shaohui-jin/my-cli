import{d as _,I as P,r as w,c as E,o as T,u as m,b as e,e as t,F as f,f as a,a5 as q,a6 as D,a7 as A,p as N,_ as I,E as v,a8 as O,l as R}from"./index-1d98e04c.js";import{U as L}from"./user-7ed7f2b6.js";const k=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=(()=>{if(typeof document>"u")return!1;const n=k[0],o={};for(const l of k)if((l==null?void 0:l[1])in document){for(const[s,i]of l.entries())o[n[s]]=i;return o}return!1})(),x={change:c.fullscreenchange,error:c.fullscreenerror};let u={request(n=document.documentElement,o){return new Promise((l,r)=>{const s=()=>{u.off("change",s),l()};u.on("change",s);const i=n[c.requestFullscreen](o);i instanceof Promise&&i.then(s).catch(r)})},exit(){return new Promise((n,o)=>{if(!u.isFullscreen){n();return}const l=()=>{u.off("change",l),n()};u.on("change",l);const r=document[c.exitFullscreen]();r instanceof Promise&&r.then(l).catch(o)})},toggle(n,o){return u.isFullscreen?u.exit():u.request(n,o)},onchange(n){u.on("change",n)},onerror(n){u.on("error",n)},on(n,o){const l=x[n];l&&document.addEventListener(l,o,!1)},off(n,o){const l=x[n];l&&document.removeEventListener(l,o,!1)},raw:c};Object.defineProperties(u,{isFullscreen:{get:()=>!!document[c.fullscreenElement]},element:{enumerable:!0,get:()=>document[c.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>!!document[c.fullscreenEnabled]}});c||(u={isEnabled:!1});const b=u,U=N(()=>I(()=>import("./userNews-0d1dca9e.js"),["assets/userNews-0d1dca9e.js","assets/index-1d98e04c.js","assets/index-2648dcb0.css"])),$=_({setup(){const{proxy:n}=R(),o=P(),l=w(),r=w(!1),s=w("mini"),i=E(()=>m().useUserStore.userInfo),p=E(()=>m().useThemeStore),h=E(()=>{const{layout:d,isClassicSplitMenu:F}=m().useThemeStore;return d==="default"||d==="classic"&&!F||d==="columns"?1:null}),g=()=>{if(!b.isEnabled)return v.warning("暂不不支持全屏"),!1;b.toggle(),b.on("change",()=>{r.value=b.isFullscreen})},y=()=>{n.mittBus.emit("openSettingDrawer")},B=d=>{d==="logOut"?O({closeOnClickModal:!1,closeOnPressEscape:!1,title:"提示",message:"此操作将退出登录, 是否继续?",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:(F,C,S)=>{F==="confirm"?(C.confirmButtonLoading=!0,C.confirmButtonText="退出中",setTimeout(()=>{S(),setTimeout(()=>{C.confirmButtonLoading=!1},300)},700)):S()}}).then(()=>{L.signOut().then(()=>{o.push("/login"),setTimeout(()=>{v.success("安全退出成功！")},300)})}).catch(()=>{}):o.push(d)},z=()=>{l.value.openSearch()},M=d=>{p.value.globalComponentSize=d,window.location.reload()};return T(()=>{s.value=m().useThemeStore.globalComponentSize}),{userInfo:i,layoutUserFlexNum:h,isScreenFull:r,disabledSize:s,onLayoutSettingClick:y,onHandleCommandClick:B,onScreenFullClick:g,onSearchClick:z,onComponentSizeChange:M}},render(){const{userInfo:n,layoutUserFlexNum:o,isScreenFull:l,disabledSize:r,onLayoutSettingClick:s,onHandleCommandClick:i,onScreenFullClick:p,onSearchClick:h,onComponentSizeChange:g}=this;return e(f,null,[e("div",{class:"layout-navbar-breadcrumb-user",style:`${o?"flex: "+o:""}`},[e(t("el-dropdown"),{"show-timeout":70,"hide-timeout":50,trigger:"click",onCommand:g},{default:()=>[e("div",{class:"layout-navbar-breadcrumb-user-icon"},[e("i",{class:"iconfont icon-ziti",title:"组件大小"},null)])],dropdown:()=>e(f,null,[e(t("el-dropdown-menu"),null,{default:()=>[e(t("el-dropdown-item"),{command:"",disabled:r===""},{default:()=>[a("默认")]}),e(t("el-dropdown-item"),{command:"medium",disabled:r==="medium"},{default:()=>[a("中等")]}),e(t("el-dropdown-item"),{command:"small",disabled:r==="small"},{default:()=>[a("小型")]}),e(t("el-dropdown-item"),{command:"mini",disabled:r==="mini"},{default:()=>[a("超小")]})]})])}),e("div",{class:"layout-navbar-breadcrumb-user-icon",onClick:h},[e(t("el-icon"),{title:"菜单搜索"},{default:()=>[e(q,null,null)]})]),e("div",{class:"layout-navbar-breadcrumb-user-icon",onClick:s},[e("i",{class:"icon-skin iconfont",title:"布局配置"},null)]),e("div",{class:"layout-navbar-breadcrumb-user-icon"},[e(t("el-popover"),{placement:"bottom",trigger:"hover",width:300,"popper-class":"el-popover-pupop-user-news"},{default:()=>[e(U,null,null)],reference:()=>e(f,null,[e(t("el-badge"),{"is-dot":!0},{default:()=>[e(t("el-icon"),{title:"消息"},{default:()=>[e(D,null,null)]})]})])})]),e("div",{class:"layout-navbar-breadcrumb-user-icon mr10",onClick:p},[e("i",{title:l?"关全屏":"开全屏",class:["iconfont",l?"icon-tuichuquanping":"icon-fullscreen"]},null)]),e(t("el-dropdown"),{"show-timeout":70,"hide-timeout":50,onCommand:i},{default:()=>[e("span",{class:"layout-navbar-breadcrumb-user-link"},[e("img",{src:n.photo,class:"layout-navbar-breadcrumb-user-link-photo mr5"},null),n.username===""?"test":n.username,e(t("el-icon"),{class:"el-icon--right"},{default:()=>[e(A,null,null)]})])],dropdown:()=>e(f,null,[e(t("el-dropdown-menu"),null,{default:()=>[e(t("el-dropdown-item"),{command:"/home"},{default:()=>[a("首页")]}),e(t("el-dropdown-item"),{command:"/personal"},{default:()=>[a("个人中心")]}),e(t("el-dropdown-item"),{command:"/404"},{default:()=>[a("404")]}),e(t("el-dropdown-item"),{command:"/401"},{default:()=>[a("401")]}),e(t("el-dropdown-item"),{divided:!0,command:"logOut"},{default:()=>[a("退出登录")]})]})])})])])}});export{$ as default};
